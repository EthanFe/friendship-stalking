(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t){},190:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s.n(a),i=s(79),r=s.n(i),o=(s(89),s(1)),c=s(2),l=s(4),m=s(3),u=s(5),p=(s(91),s(51)),d=s.n(p),g=s(80),h=s(33),v=s(22),f=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("form",{onSubmit:function(t){return e.props.addComment(t,e.props.repoID,e.props.commitURL)}},n.a.createElement("input",{type:"text",placeholder:"Add a comment",value:this.props.commentText||"",onChange:function(t){return e.props.commentTextChanged(t,e.props.repoID)}})))}}]),t}(a.Component),b=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,this.props.messages.map(function(e,t){return n.a.createElement("div",{className:"conversation-message",key:t},e.sender,": ",e.message)}),this.props.canMakeComments?n.a.createElement(f,{addComment:this.props.addComment,commentText:this.props.commentText,commentTextChanged:this.props.commentTextChanged,repoID:this.props.repoID,commitURL:this.props.commitURL}):null)}}]),t}(a.Component),L=s(21),U=s.n(L),w=function(e){function t(){var e,s;Object(o.a)(this,t);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(s=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(n)))).componentDidMount=function(){U()({targets:".user-view",translateY:250,duration:1200})},s.prettifyRepoName=function(e){return e=(e=e.split("/")[1]).replace(/-/g," "),e=s.capitalize(e),e=s.separateCamelCase(e)},s.capitalize=function(e){return e.split(" ").map(function(e){return e[0].toUpperCase()+e.slice(1)}).join(" ")},s.separateCamelCase=function(e){var t=e.split("");return t=t.map(function(e,t){return 0!==t&&e.toUpperCase()===e&&e.toLowerCase()!==e?" "+e:e})},s}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.user,t=e.name,s=e.date,a=e.repo,i=e.repoID,r=e.commitMessage,o=e.commitURL,c="user-commit-info";return this.props.ownedByUser&&(c+=" owned-by-user"),n.a.createElement("div",{className:"user-view"},n.a.createElement("a",{href:o},n.a.createElement("div",{className:c},n.a.createElement("h1",null,this.prettifyRepoName(a)),n.a.createElement("p",null,t," (",s.toLocaleString(),")"),n.a.createElement("p",null,'"',r,'"'))),n.a.createElement(b,{repoID:i,commitURL:o,messages:this.props.messages,commentTextChanged:this.props.commentTextChanged,commentText:this.props.commentBeingWritten,addComment:this.props.addComment,canMakeComments:this.props.canMakeComments}))}}]),t}(a.Component),C=function(e){function t(){var e,s;Object(o.a)(this,t);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(s=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(n)))).componentDidUpdate=function(e){console.log(s.props.addUserErrorMessage,e.addUserErrorMessage),s.props.addUserErrorMessage!==e.addUserErrorMessage&&""!==s.props.addUserErrorMessage&&(s.animation&&s.animation.restart(),s.animation=U()({targets:".error-message",color:"#8B0000",easing:"linear",duration:350,"font-size":"12px"}))},s}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"user-view"},n.a.createElement("div",{className:"user-commit-info new"},n.a.createElement("h2",null,"Add a new user to this list!"),n.a.createElement("form",{onSubmit:this.props.addUserToList},n.a.createElement("input",{type:"text",placeholder:"Github Username",value:this.props.newUserName,onChange:this.props.newUserNameChanged})),n.a.createElement("div",{className:"error-message"},this.props.addUserErrorMessage)))}}]),t}(a.Component),D=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"user-list"},this.props.users.map(function(t){var s=e.props.activeConversations.find(function(e){return parseInt(e.repoID)===t.repoID});return console.log(t.name+e.props.listDisplayedAt),n.a.createElement("div",{key:t.name+e.props.listDisplayedAt},n.a.createElement(w,{user:t,messages:s?s.messages:[],commentTextChanged:e.props.commentTextChanged,commentBeingWritten:e.props.commentsBeingWritten[t.repoID],addComment:e.props.addComment,ownedByUser:t.name===e.props.loggedInUser,canMakeComments:null!==e.props.loggedInUser}))}),n.a.createElement(C,{newUserName:this.props.newUserName,newUserNameChanged:this.props.newUserNameChanged,addUserToList:this.props.addUserToList,addUserErrorMessage:this.props.addUserErrorMessage}))}}]),t}(a.Component),j=s(81),O=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.list.users;t.sort(function(e,t){return e.localeCompare(t)});var s="userlist-box";return this.props.selected&&(s+=" selected-userlist-box"),this.props.loading&&(s+=" loading-userlist-box"),n.a.createElement("div",{className:s,onClick:function(){return e.props.requestDataForList(e.props.listID)}},n.a.createElement("div",null,n.a.createElement("div",{className:"userlist-title"},this.props.list.title),t.map(function(e){return n.a.createElement("div",{className:"userlist-member"},e)})),n.a.createElement("div",{className:"loader-container"},n.a.createElement(j.PropagateLoader,{style:{display:"block",margin:"0 auto","border-color":"red"},sizeUnit:"px",size:8,color:"#C6F8FF",loading:this.props.loading})))}}]),t}(a.Component),E=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"userlist-box"},n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("input",{type:"text",placeholder:"List Name",value:this.props.newListName,onChange:this.props.newListNameChanged})),n.a.createElement("button",{onClick:this.props.createNewList},"Create New Userlist")))}}]),t}(a.Component),N=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"sidebar"},n.a.createElement("span",{className:"username"},this.props.loggingIn?"Logging in...":"Logged in as ".concat(this.props.loggedInUser)),n.a.createElement("div",null,this.props.visibleUserLists?this.props.visibleUserLists.map(function(t){return n.a.createElement(O,{list:t,key:t.id,listID:t.id,requestDataForList:e.props.requestDataForList,selected:e.props.displayedList===t.id,loading:e.props.loadingList===t.id})}):null,n.a.createElement(E,{newListName:this.props.newListName,newListNameChanged:this.props.newListNameChanged,createNewList:this.props.createNewList})))}}]),t}(a.Component),y=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"login-button"},n.a.createElement("a",{href:"https://github.com/login/oauth/authorize?scope=read:user%20repo&client_id=".concat("37ec24a03b485597e01b")},"Login with Github!"))}}]),t}(a.Component),k=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={loggingIn:!1,newListName:"",displayedList:null,commentsBeingWritten:{},activeConversations:[],newUserName:"",loadingUserList:!1},a.componentDidMount=function(){a.setupSocket(),a.authenticateWithAccessToken()},a.authenticateWithAccessToken=function(){var e=localStorage.getItem("githubAccessToken");null!==e&&(a.setState({loggingIn:!0}),a.socket.emit("authWithGithub",{token:e}))},a.authenticateWithAccessCode=function(){if(!a.state.loggingIn){var e=window.location.href.split("/?code=");if(e.length>1){a.setState({loggingIn:!0});var t=e[1];a.socket.emit("authWithGithub",{code:t})}}},a.setupSocket=function(){var e=s(160)();e.on("commentAdded",a.receiveComment),e.on("authenticationSuccess",a.loginSuccess),e.on("authenticationFailure",a.loginFailure),e.on("userDataForDisplay",a.displayUserList),e.on("userAddedToList",a.userAddedToList),e.on("addUserToListResponse",a.addUserToListResponse),e.on("dataForUserlistResponse",a.addVisibleUserList),e.on("createdNewList",a.createdNewList),a.socket=e,e.on("connect",a.authenticateWithAccessCode)},a.loginSuccess=function(e){a.setState({loggingIn:!1}),console.log("Logged in and got token back!",e.loginData.accessToken),localStorage.setItem("githubAccessToken",e.loginData.accessToken),a.setState({loginData:e.loginData}),a.setInitialListsState(e.userlistsData)},a.loginFailure=function(){a.setState({loggingIn:!1}),console.log("Failed to login"),localStorage.removeItem("githubAccessToken")},a.setInitialReposState=function(e){a.setState({activeConversations:e.conversations,users:e.users.map(a.shapeDataForUser).sort(function(e,t){return t.date.getTime()-e.date.getTime()})})},a.setInitialListsState=function(e){a.setState({visibleUserLists:e})},a.shapeDataForUser=function(e){return{name:e.name,repo:e.data.repo.name,repoID:e.data.repo.id,commitID:e.data.payload.push_id,commitMessage:e.data.payload.commits[0].message,commitURL:e.data.payload.commits[0].url.replace("api.","").replace("/repos","").replace("commits","commit"),date:new Date(e.data.created_at)}},a.requestDataForList=function(e){a.setState({displayedList:e,loadingUserList:!0}),a.socket.emit("requestReposForList",{listID:e,accessToken:a.state.loginData.accessToken});U()({targets:".user-view",translateY:-200,duration:1200})},a.displayUserList=function(e){var t=e.userData,s=e.conversations;console.log(t),a.setState({users:t.map(a.shapeDataForUser).sort(function(e,t){return t.date.getTime()-e.date.getTime()}),newUserName:"",addUserErrorMessage:"",loadingUserList:!1,activeConversations:s,listDisplayedAt:(new Date).getTime()})},a.receiveComment=function(e){var t=Object(v.a)(a.state.activeConversations),s=t.find(function(t){return parseInt(t.repoID)===e.repoID});void 0!==s?s=Object(h.a)({},s):(s={messages:[],repoID:String(e.repoID)},t.push(s)),s.messages.push({message:e.commentContent,sender:e.username}),a.setState({activeConversations:t})},a.userAddedToList=function(e){var t=e.listID,s=e.username;s===a.state.loginData.basicUserData.login&&a.socket.emit("requestDataForUserlist",{listID:t});var n=a.state.visibleUserLists.find(function(e){return e.id===t});if(void 0!==n){var i=Object(v.a)(n.users).concat([s]),r=Object(v.a)(a.state.visibleUserLists);r[r.indexOf(n)].users=i,a.setState({visibleUserLists:r}),t===a.state.displayedList&&a.requestDataForList(t)}},a.addUserToListResponse=function(e){var t=e.message;a.setState({addUserErrorMessage:t})},a.addVisibleUserList=function(e){var t=e.listData;a.setState({visibleUserLists:Object(v.a)(a.state.visibleUserLists).concat([t])})},a.createdNewList=function(e){var t=e.listData;a.setState({visibleUserLists:Object(v.a)(a.state.visibleUserLists).concat([t])})},a.createNewList=function(){a.socket.emit("createNewList",{name:a.state.newListName,username:a.state.loginData.basicUserData.login}),console.log("Making new list with name "+a.state.newListName),a.setState({newListName:""})},a.newListNameChanged=function(e){a.setState({newListName:e.target.value})},a.getLoggedInUser=function(){return void 0!==a.state.loginData?a.state.loginData.basicUserData.login:null},a.commentTextChanged=function(e,t){var s=Object(h.a)({},a.state.commentsBeingWritten);s[t]=e.target.value,a.setState({commentsBeingWritten:s})},a.addComment=function(){var e=Object(g.a)(d.a.mark(function e(t,s,n){var i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a.socket.emit("addComment",{repoID:s,commitURL:n,commentContent:a.state.commentsBeingWritten[s],topic:a.state.users.find(function(e){return e.repoID===s}).repo,username:a.state.loginData.basicUserData.login,accessToken:a.state.loginData.accessToken}),delete(i=Object(h.a)({},a.state.commentsBeingWritten))[s],a.setState({commentsBeingWritten:i});case 5:case"end":return e.stop()}},e,this)}));return function(t,s,a){return e.apply(this,arguments)}}(),a.newUserNameChanged=function(e){a.setState({newUserName:e.target.value})},a.addUserToList=function(e){e.preventDefault(),a.setState({newUserName:"",addUserErrorMessage:""}),a.socket.emit("addUserToList",{listID:a.state.displayedList,username:a.state.newUserName,accessToken:a.state.loginData.accessToken})},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return null!==this.getLoggedInUser()?n.a.createElement("div",{className:"main-view"},n.a.createElement(N,{loggingIn:this.state.loggingIn,loggedInUser:this.getLoggedInUser(),createNewList:this.createNewList,newListName:this.state.newListName,newListNameChanged:this.newListNameChanged,visibleUserLists:this.state.visibleUserLists,requestDataForList:this.requestDataForList,displayedList:this.state.displayedList,loadingList:this.state.loadingUserList?this.state.displayedList:null}),this.state.loginData?this.state&&this.state.users?n.a.createElement(D,{users:this.state.users,activeConversations:this.state.activeConversations,commentsBeingWritten:this.state.commentsBeingWritten,commentTextChanged:this.commentTextChanged,addComment:this.addComment,loggedInUser:this.state.loginData?this.state.loginData.basicUserData.login:null,newUserName:this.state.newUserName,newUserNameChanged:this.newUserNameChanged,addUserToList:this.addUserToList,addUserErrorMessage:this.state.addUserErrorMessage,listDisplayedAt:this.state.listDisplayedAt}):n.a.createElement("h2",null,"Select a list of users to display!"):null):n.a.createElement(y,null)}}]),t}(a.Component),I=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement(k,null)}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},84:function(e,t,s){e.exports=s(190)},89:function(e,t,s){},91:function(e,t,s){}},[[84,2,1]]]);
//# sourceMappingURL=main.a9c3a381.chunk.js.map